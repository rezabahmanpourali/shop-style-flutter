# راهنمای استفاده از API های احراز هویت

## مراحل ورود به برنامه

### 1. درخواست کد تایید
برای ورود به برنامه، اول باید درخواست کد تایید بدید:
```
POST /auth/customers/otp/
body: {
    "phone": "09123456789"  // شماره موبایل کاربر
}
```
بعد از این درخواست، یک پیامک حاوی کد تایید برای کاربر ارسال میشه.

**نکات مهم:**
- کد تایید فقط 2 دقیقه اعتبار داره
- در هر دقیقه فقط یک بار میشه درخواست کد داد
- در هر روز فقط 3 بار میشه درخواست کد کرد

### 2. وارد کردن کد تایید
بعد از دریافت کد، باید اون رو به این آدرس بفرستید:
```
POST /auth/customers/verify/
body: {
    "phone": "09123456789",  // همون شماره موبایل
    "otp": "123456"  // کد دریافت شده
}
```

اگر کد درست باشه، سرور دو تا توکن میده:
1. `access_token`: برای انجام کارهای معمولی (30 دقیقه اعتبار داره)
2. `refresh_token`: برای گرفتن توکن جدید وقتی توکن قبلی منقضی شده (7 روز اعتبار داره)

## بقیه کارهایی که میشه انجام داد

### گرفتن توکن جدید
وقتی توکن access_token منقضی شد، با refresh_token میتونید یه توکن جدید بگیرید:
```
POST /auth/customers/refresh/
headers: {
    "Authorization": "Bearer {refresh_token}"  // توکن refresh که قبلا گرفتید
}
```

### دیدن اطلاعات کاربر
برای دیدن اطلاعات خودتون:
```
GET /auth/customers/me/
headers: {
    "Authorization": "Bearer {access_token}"
}
```

### تغییر اطلاعات کاربر
برای تغییر اطلاعات شخصی:
```
PUT /auth/customers/edit/
headers: {
    "Authorization": "Bearer {access_token}"
}
body: {
    "name": "نام جدید",  // هر کدوم رو که میخواید تغییر بدید
    "lastn": "نام خانوادگی جدید",
    "face_form": "گرد",
    "hair_form": "صاف",
    "ryecolor": "مشکی",
    "like_hair": "کوتاه"
}
```

### کار با آدرس‌ها

#### اضافه کردن آدرس جدید:
```
POST /auth/customers/addresses/
headers: {
    "Authorization": "Bearer {access_token}"
}
body: {
    "address": "آدرس کامل"
}
```

#### دیدن لیست آدرس‌ها:
```
GET /auth/customers/addresses/
headers: {
    "Authorization": "Bearer {access_token}"
}
```

### خروج از حساب کاربری
برای خروج از حساب:
```
POST /auth/customers/logout
headers: {
    "Authorization": "Bearer {refresh_token}"
}
```

## نکات مهم
1. همیشه توکن رو با پیشوند Bearer بفرستید
2. اگر با خطای 401 مواجه شدید یعنی یا توکن اشتباهه یا منقضی شده
3. اگر با خطای 400 مواجه شدید یعنی اطلاعات ارسالی اشتباهه
4. اگر با خطای 429 مواجه شدید یعنی تعداد درخواست‌هاتون زیاد بوده، باید صبر کنید 
